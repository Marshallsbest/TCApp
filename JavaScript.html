<script>
  window.addEventListener('load', function() {
    console.log('Page is loaded');
    setFocusToTextBox();
  });
  // Loading animation 
  function handleFormSubmit(){
    console.log("This Log is after the form object log");
    document.getElementById("logButton").disabled=true;
    document.getElementById("output").innerhtml="processing";
    let customerSelect = document.getElementById("customerSelect").value;
    let customerName = document.getElementById("customerName").value;
    let machineSelect = document.getElementById("machineSelect").value;
    let machineName = document.getElementById("machineName").value;
    let logEntry = document.getElementById("logEntry").value;
    let hours = document.getElementById("totalHours").value;
    let order = document.getElementById("workOrder").value;
    let formObject = {
          customerSelect:customerSelect,
          customerName:customerName,
          machineSelect:machineSelect,
          machineName:machineName,
          logEntry:logEntry,
          totalHours:hours,
          workOrder:order
        };
    console.log(formObject);
    google.script.run.withSuccessHandler(onSuccess).withFailureHandler(onFailure).AddResponse(formObject);
  };
  
  function onSuccess(message){
    console.log("I was called! ");
    clearForm();
    window.scrollTo(0,0); 
    let div = document.getElementById("output");
    let addAnother = document.getElementById("logButton");
    addAnother.innerHTML = "Add Another Entry";
    div.innerHTML = message;
    setFocusToTextBox();
  };
  
  function clearForm(){
    const 1 = document.getElementById("customerSelect");
    const 2 = document.getElementById("customerName");
    const 3 = document.getElementById("machineSelect");
    const 4 = document.getElementById("machineName");
    const 5 = document.getElementById("logEntry");
    const 6 = document.getElementById("totalHours");
    const 7 = document.getElementById("workOrder");
    
  let reset = [1,2,3,4,5,6,7];
    reset.forEach(ele){function(
    reset.refresh();
    document.
    )};
  };

  function onFailure(message){
    console.log("Failure Handler Was Called"+ message)
    document.getElementById("output").innerHTML="Failure Handler Was Called: "+ message;
  };

  function setFocusToTextBox(){
    document.getElementById("customerSelect").focus();
  
  };

  function EmailSheet(){
    addSpinner('is-active');
    google.script.run.withSuccessHandler(EmailSuccess).withFailureHandler(EmailFailure).EmailCurrentSheet();
  };

  function EmailSuccess(message){
    let ss = SpreadSheetApp.getActiveSpreadsheet();
    clearForm();
    let div = document.getElementById("output");
    let addAnother = document.getElementById("EmailButton");
    addAnother.innerHTML = "Email Again?";
    div.innerHTML = message;
    setFocusToTextBox()
  removeSpinner('is-active');

  }
   function EmailFailure(message){
    console.log("Failure to Send Email"+ message)
  removeSpinner('is-active');
  };

 </script>